<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>a31c04ac1eec4d28934f0b516b998dd5</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown">
<div style="border:solid firebrick 2px; padding: 20px">
<h1 id="описание-проекта">Описание проекта</h1>
<p>Вы решили открыть небольшое кафе в Москве. Оно оригинальное — гостей должны обслуживать роботы. Проект многообещающий, но дорогой. Вместе с партнёрами вы решились обратиться к инвесторам. Их интересует текущее положение дел на рынке — сможете ли вы снискать популярность на долгое время, когда все зеваки насмотрятся на роботов-официантов? Вы — гуру аналитики, и партнёры просят вас подготовить исследование рынка. У вас есть открытые данные о заведениях общественного питания в Москве.</p>
<h2 id="шаг-1-загрузите-данные-и-подготовьте-их-к-анализу">Шаг №1. Загрузите данные и подготовьте их к анализу</h2>
<p>Загрузите данные о заведениях общественного питания Москвы. Убедитесь, что тип данных в каждой колонке — правильный, а также отсутствуют пропущенные значения и дубликаты. При необходимости обработайте их.</p>
<h2 id="шаг-2-анализ-данных">Шаг №2. Анализ данных</h2>
<pre><code>•	Исследуйте соотношение видов объектов общественного питания по количеству. Постройте график.
•	Исследуйте соотношение сетевых и несетевых заведений по количеству. Постройте график.
•	Для какого вида объекта общественного питания характерно сетевое распространение?
•	Что характерно для сетевых заведений: много заведений с небольшим числом посадочных мест в каждом или мало заведений с большим количеством посадочных мест?
•	Для каждого вида объекта общественного питания опишите среднее количество посадочных мест. Какой вид предоставляет в среднем самое большое количество посадочных мест? Постройте графики.
•	Выделите в отдельный столбец информацию об улице из столбца address .
•	Постройте график топ-10 улиц по количеству объектов общественного питания. Воспользуйтесь внешней информацией и ответьте на вопрос — в каких районах Москвы находятся эти улицы?
•	Найдите число улиц с одним объектом общественного питания. Воспользуйтесь внешней информацией и ответьте на вопрос — в каких районах Москвы находятся эти улицы?
•	Посмотрите на распределение количества посадочных мест для улиц с большим количеством объектов общественного питания. Какие закономерности можно выявить?</code></pre>
<p>Сделайте общий вывод и дайте рекомендации о виде заведения, количестве посадочных мест, а также районе расположения. Прокомментируйте возможность развития сети.</p>
<h2 id="шаг-3-подготовка-презентации">Шаг №3. Подготовка презентации</h2>
<p>Подготовьте презентацию исследования для инвесторов. Для создания презентации используйте любой удобный инструмент, но отправить презентацию нужно обязательно в формате pdf. Приложите ссылку на презентацию в markdown-ячейке в формате: Скопировать кодMARKDOWN Презентация: <ссылка на облачное хранилище с презентацией> Следуйте принципам оформления из темы «Подготовка презентации».</p>
</div>
<div class="cell code" data-execution_count="1">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import stringdist</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">&#39;/datasets/rest_data.csv&#39;</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>data.object_name <span class="op">=</span> data.object_name.<span class="bu">str</span>.lower()</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="1">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>object_name</th>
      <th>chain</th>
      <th>object_type</th>
      <th>address</th>
      <th>number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>151635</td>
      <td>сметана</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, улица Егора Абакумова, дом 9</td>
      <td>48</td>
    </tr>
    <tr>
      <td>1</td>
      <td>77874</td>
      <td>родник</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, улица Талалихина, дом 2/1, корпус 1</td>
      <td>35</td>
    </tr>
    <tr>
      <td>2</td>
      <td>24309</td>
      <td>кафе «академия»</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, Абельмановская улица, дом 6</td>
      <td>95</td>
    </tr>
    <tr>
      <td>3</td>
      <td>21894</td>
      <td>пиццетория</td>
      <td>да</td>
      <td>кафе</td>
      <td>город Москва, Абрамцевская улица, дом 1</td>
      <td>40</td>
    </tr>
    <tr>
      <td>4</td>
      <td>119365</td>
      <td>кафе «вишневая метель»</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, Абрамцевская улица, дом 9, корпус 1</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Для обного и того же объекта может быть разные типы и признак сети. Найдем функцию, которая покажет самые частые тип объекта и параментр "chain" и присвоим объекту эти значения:</p>
</div>
<div class="cell code" data-execution_count="2">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dic(column):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    dic <span class="op">=</span> (data.groupby([<span class="st">&#39;object_name&#39;</span>, column]).agg({<span class="st">&#39;id&#39;</span>:<span class="st">&#39;count&#39;</span>})</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                .sort_values(by<span class="op">=</span>[<span class="st">&#39;object_name&#39;</span>, column], ascending<span class="op">=</span>[<span class="va">True</span>,<span class="va">False</span>]).reset_index()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                .groupby(<span class="st">&#39;object_name&#39;</span>).agg({column:<span class="st">&#39;first&#39;</span>,<span class="st">&#39;id&#39;</span>:<span class="st">&#39;first&#39;</span>}))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dic[column].to_dict()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="3">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dic_type_obj <span class="op">=</span> dic(<span class="st">&#39;object_type&#39;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dic_chain <span class="op">=</span> dic(<span class="st">&#39;chain&#39;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>data.<span class="bu">apply</span>(<span class="kw">lambda</span> x: dic_type_obj[x[<span class="st">&#39;object_name&#39;</span>]], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>data.<span class="bu">apply</span>(<span class="kw">lambda</span> x: dic_chain[x[<span class="st">&#39;object_name&#39;</span>]], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>object_name</th>
      <th>chain</th>
      <th>object_type</th>
      <th>address</th>
      <th>number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>151635</td>
      <td>сметана</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, улица Егора Абакумова, дом 9</td>
      <td>48</td>
    </tr>
    <tr>
      <td>1</td>
      <td>77874</td>
      <td>родник</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, улица Талалихина, дом 2/1, корпус 1</td>
      <td>35</td>
    </tr>
    <tr>
      <td>2</td>
      <td>24309</td>
      <td>кафе «академия»</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, Абельмановская улица, дом 6</td>
      <td>95</td>
    </tr>
    <tr>
      <td>3</td>
      <td>21894</td>
      <td>пиццетория</td>
      <td>да</td>
      <td>кафе</td>
      <td>город Москва, Абрамцевская улица, дом 1</td>
      <td>40</td>
    </tr>
    <tr>
      <td>4</td>
      <td>119365</td>
      <td>кафе «вишневая метель»</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, Абрамцевская улица, дом 9, корпус 1</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Для работы с дубликатами напишем цикл, который создаст автоматически словарь синонимов: хочу использовать предположение о том, что если слова однокоренные, то различие между строками будет минимальным (например, 3 символа). Поэтому я нахожу разницу между первой строкой и всеми остальными (алгоритм Левенштейна), и если она меньше трех - записываю в словарь.</p>
<p><font color='06623b'> Словарь будет следующего вида: {исходные_термин : массив_близких_терминов, ...}</p>
</div>
<div class="cell code" data-execution_count="4">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>unique_name <span class="op">=</span> <span class="bu">sorted</span>(data[<span class="st">&#39;object_name&#39;</span>].unique().tolist())</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>unique_address <span class="op">=</span> <span class="bu">sorted</span>(data[<span class="st">&#39;address&#39;</span>].unique().tolist())</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="5">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># result = []</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># obj_names = data[&#39;object_name&#39;].head(300).unique().tolist()</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># # enumerate - создает кортеж из индекса элемента и самого элемента</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for i, obj_name in enumerate(obj_names):</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     # чтобы два раза не перебирать</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     for obj_name2 in obj_names[i + 1:]:</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co">#         lev_dist = edit_distance(obj_name, obj_name2)</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">#         if lev_dist &lt;= 3:</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#             result += [[obj_name, obj_name2, lev_dist]]</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># result = pd.DataFrame(result, columns = [&#39;source&#39;, &#39;alternative&#39;, &#39;lev_dist&#39;])</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># result = result.groupby(&#39;source&#39;).agg({&#39;alternative&#39;: &#39;unique&#39;})[&#39;alternative&#39;].to_dict()</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># result</span></span></code></pre></div>
</div>
<div class="cell markdown">
<p><font color='06623b'> К сожалению, достоверного справочника не получается, но он показывает основные "термины" - наиболее популярные варианты названий (seasrch_name).</p>
<p><font color='06623b'> Напишем функцию, которая составит словарь унифицированных названий объектов.</p>
</div>
<div class="cell code" data-execution_count="6">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data[data[&#39;object_name&#39;].str.contains(&#39;иль-патио&#39;)].object_name.unique().tolist()</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="7">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>dict_ <span class="op">=</span> {<span class="st">&#39;шоколадница&#39;</span>:[<span class="st">&#39;шоколадница&#39;</span>, <span class="st">&#39;шоколадница кофе хаус&#39;</span>, <span class="st">&#39;кофейня «шоколадница»&#39;</span>, <span class="st">&#39;кафе «шоколадница»&#39;</span>, <span class="st">&#39;кофейня шоколадница&#39;</span>, <span class="st">&#39;шоколадница экспресс&#39;</span>, <span class="st">&#39;шоколадница кофемания&#39;</span>],</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;макдоналдс&#39;</span>:[<span class="st">&#39;макдоналдс&#39;</span>, <span class="st">&#39;ресторан «макдоналдс»&#39;</span>, <span class="st">&#39;предприятие быстрого обслуживания «макдоналдс»&#39;</span>, <span class="st">&#39;москва - макдоналдс&#39;</span>, <span class="st">&#39;кафе макдоналдс&#39;</span>, <span class="st">&#39;кафе «макдоналдс»&#39;</span>, <span class="st">&#39;ресторан«макдоналдс»&#39;</span>],</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;бургер кинг&#39;</span>:[<span class="st">&#39;ресторан «бургер кинг»&#39;</span>, <span class="st">&#39;бургер кинг&#39;</span>, <span class="st">&#39;предприятие быстрого обслуживания «бургер кинг»&#39;</span>, <span class="st">&#39;бургер кинг burger king&#39;</span>, <span class="st">&#39;кафе бургер кинг&#39;</span>, <span class="st">&#39;закусочная «бургер кинг»&#39;</span>, <span class="st">&#39;кафе-закусочная «бургер кинг»&#39;</span>, <span class="st">&#39;кафе «бургер кинг»&#39;</span>, <span class="st">&#39;бургер кинг burger king&#39;</span>, <span class="st">&#39;burgerking&#39;</span>],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;bb burgers&#39;</span>:[<span class="st">&#39;ресторан «bb burgers»&#39;</span>,<span class="st">&#39;bb энд burger&#39;</span>, <span class="st">&#39;bb grill&#39;</span>, <span class="st">&#39;ресторан «bb grill»&#39;</span>, <span class="st">&#39;ресторан «bb burgers»&#39;</span>, <span class="st">&#39;bb &amp; burgers&#39;</span>],</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;black star&#39;</span>:[<span class="st">&#39;black star burgers&#39;</span>, <span class="st">&#39;black star burger prime&#39;</span>, <span class="st">&#39;black star burger&#39;</span>],</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;coffee moose&#39;</span>:[<span class="st">&#39;coffee moose&#39;</span>, <span class="st">&#39;кафе «coffee moose»&#39;</span>, <span class="st">&#39;coffee moose кофейня&#39;</span>,<span class="st">&#39;koffee moose&#39;</span>],</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;cofix&#39;</span>:[<span class="st">&#39;cofix&#39;</span>, <span class="st">&#39;cofix-bright&#39;</span>, <span class="st">&#39;кофейня «cofix»&#39;</span>, <span class="st">&#39;кофейня cofix&#39;</span>, <span class="st">&#39;cofix+plombir&#39;</span>],</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;dim sum&#39;</span>:[<span class="st">&#39;dim sun&#39;</span>, <span class="st">&#39;dim sum &amp; co&#39;</span>, <span class="st">&#39;кафе dim sum &amp; c0&#39;</span>, <span class="st">&#39;dimsum&amp;co&#39;</span>, <span class="st">&#39;ресторан «dim sum &amp; co»&#39;</span>, <span class="st">&#39;dim sum&#39;</span>, <span class="st">&#39;dim sum&amp;co&#39;</span>, <span class="st">&#39;dim&amp;sam&#39;</span>],</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;вареничная&#39;</span>: [<span class="st">&#39;вареничная №1&#39;</span>, <span class="st">&#39;вареничная № 1&#39;</span>, <span class="st">&#39;вареничная&#39;</span>, <span class="st">&#39;ресторан «вареничная №1»&#39;</span>, <span class="st">&#39;вареничная (хинкальная)&#39;</span>, <span class="st">&#39;кафе «вареничная №1»&#39;</span>, <span class="st">&#39;вареничная 1&#39;</span>],</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;волконский&#39;</span>:[<span class="st">&#39;волконский&#39;</span>, <span class="st">&#39;кондитерская волконский&#39;</span>, <span class="st">&#39;волконский у дома&#39;</span>, <span class="st">&#39;кондитерская-пекарня волконский&#39;</span>,  <span class="st">&#39;пекарня «волконский хлеб»&#39;</span>, <span class="st">&#39;пекарня волконский&#39;</span>, <span class="st">&#39;кафе «волконский»&#39;</span>, <span class="st">&#39;кафе волконский пекарня&#39;</span>, <span class="st">&#39;кафе-пекарея «волконский»&#39;</span>],</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;суши сет&#39;</span>:[<span class="st">&#39;суши сет&#39;</span>, <span class="st">&#39;кафе «суши сет»&#39;</span>, <span class="st">&#39;магазин-кулинария «суши сет»&#39;</span>],</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;суши wok&#39;</span>: [<span class="st">&#39;суши wok&#39;</span>, <span class="st">&#39;сеть магазинов «суши wok»&#39;</span>, <span class="st">&#39;кафе суши wok&#39;</span>, <span class="st">&#39;кафе «суши wok»&#39;</span>, <span class="st">&#39;бар «суши wok»&#39;</span>],</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;тратория&#39;</span>: [<span class="st">&#39;тратория semplice&#39;</span>, <span class="st">&#39;тратория&#39;</span>, <span class="st">&#39;тратория italian «паста&amp;пицца»&#39;</span>,<span class="st">&#39;траттория&#39;</span>, <span class="st">&#39;траттория семпличе&#39;</span>, <span class="st">&#39;траттория пепе&#39;</span>, <span class="st">&#39;траттория на столешниковом&#39;</span>, <span class="st">&#39;кафе «траттория венеция»&#39;</span>, <span class="st">&#39;траттория венеция&#39;</span>, <span class="st">&#39;траттория пане олио&#39;</span>, <span class="st">&#39;траттория примавера&#39;</span>, <span class="st">&#39;кафе траттория терраса&#39;</span>, <span class="st">&#39;кафе «траттория модерна»&#39;</span>, <span class="st">&#39;траттория stefano&#39;</span>, <span class="st">&#39;кафе траттория&#39;</span>, <span class="st">&#39;пиццерия траттория uno&#39;</span>],</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;столовая школа&#39;</span>: [<span class="st">&#39;столовая школа 58&#39;</span>, <span class="st">&#39;столовая школа 98&#39;</span>, <span class="st">&#39;столовая школа 1543&#39;</span>, <span class="st">&#39;столовая школа «уна»&#39;</span>, <span class="st">&#39;столовая школа «наши традиции»&#39;</span>, <span class="st">&#39;столовая школа 38&#39;</span>, <span class="st">&#39;столовая школа 37&#39;</span>, <span class="st">&#39;столовая школа 14 (598)&#39;</span>, <span class="st">&#39;столовая школа 14&#39;</span>, <span class="st">&#39;столовая школа 74&#39;</span>, <span class="st">&#39;столовая школа 571&#39;</span>, <span class="st">&#39;столовая школа 1118&#39;</span>, <span class="st">&#39;столовая школа 97&#39;</span>, <span class="st">&#39;столовая школа 537 «комбинат дошкольного питания»&#39;</span>, <span class="st">&#39;столовая школа 29&#39;</span>, <span class="st">&#39;столовая школа 1485&#39;</span>, <span class="st">&#39;столовая школа 875&#39;</span>, <span class="st">&#39;столовая школа 875 (807)&#39;</span>, <span class="st">&#39;столовая школа 803&#39;</span>, <span class="st">&#39;столовая школа 73&#39;</span>, <span class="st">&#39;столовая школа 99&#39;</span>, <span class="st">&#39;столовая школа 262&#39;</span>, <span class="st">&#39;столовая школа 71&#39;</span>, <span class="st">&#39;столовая школа 261&#39;</span>, <span class="st">&#39;столовая школа 804&#39;</span>, <span class="st">&#39;столовая школа 712&#39;</span>, <span class="st">&#39;столовая школа 79&#39;</span>, <span class="st">&#39;столовая школа 84&#39;</span>, <span class="st">&#39;столовая школа 1738&#39;</span>, <span class="st">&#39;столовая школа 1741&#39;</span>, <span class="st">&#39;столовая школа 1498&#39;</span>, <span class="st">&#39;столовая школа 1905&#39;</span>, <span class="st">&#39;столовая школа-интернат №15 циркового профиля им. ю.в. никулина для детей, оставшихся без попечения&#39;</span>, <span class="st">&#39;столовая школа 1941&#39;</span>, <span class="st">&#39;столовая школа 843 (812)&#39;</span>, <span class="st">&#39;столовая школа 1448&#39;</span>, <span class="st">&#39;столовая школа структурное подразделение №2 гбоу школы 2025&#39;</span>, <span class="st">&#39;столовая школа 843&#39;</span>, <span class="st">&#39;столовая школа 1248&#39;</span>, <span class="st">&#39;столовая школа 916&#39;</span>, <span class="st">&#39;столовая школа 1485 (созвездие)&#39;</span>, <span class="st">&#39;столовая школа №939&#39;</span>, <span class="st">&#39;столовая школа №937&#39;</span>, <span class="st">&#39;столовая школа № 937&#39;</span>],</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;хинкальная&#39;</span>: [<span class="st">&#39;кафе «хинкальная»&#39;</span>, <span class="st">&#39;хинкальная&#39;</span>, <span class="st">&#39;хинкальная city&#39;</span>, <span class="st">&#39;хинкальная (на м. бирюзова)&#39;</span>, <span class="st">&#39;кафе хинкальная&#39;</span>, <span class="st">&#39;хинкальная виноград&#39;</span>, <span class="st">&#39;цинандали хинкальная&#39;</span>, <span class="st">&#39;хинкальная 777&#39;</span>, <span class="st">&#39;кафе хинкальная саамо&#39;</span>, <span class="st">&#39;хинкальная «кахури»&#39;</span>, <span class="st">&#39;хинкальная у бехо&#39;</span>, <span class="st">&#39;хинкальная №1&#39;</span>, <span class="st">&#39;мимино хинкальная&#39;</span>, <span class="st">&#39;хинкальная кинто&#39;</span>, <span class="st">&#39;хинкальная на спасской&#39;</span>, <span class="st">&#39;хинкальная, пекарня&#39;</span>, <span class="st">&#39;кафе хинкальная 11&#39;</span>, <span class="st">&#39;хинкальная №5&#39;</span>, <span class="st">&#39;хинкальная кахетия&#39;</span>, <span class="st">&#39;кафе хинкальная грузинская кухня&#39;</span>, <span class="st">&#39;ресторан хинкальная&#39;</span>, <span class="st">&#39;хинкальная чела&#39;</span>, <span class="st">&#39;новая хинкальная&#39;</span>, <span class="st">&#39;хинкальная.джи&#39;</span>, <span class="st">&#39;хинкальная батони&#39;</span>, <span class="st">&#39;хинкальная № 1&#39;</span>, <span class="st">&#39;m cafe хинкальная&#39;</span>, <span class="st">&#39;marrakesh хинкальная&#39;</span>, <span class="st">&#39;у михалыча хинкальная №1&#39;</span>, <span class="st">&#39;грузинская кухня эzо хинкальная&#39;</span>, <span class="st">&#39;вареничная (хинкальная)&#39;</span>, <span class="st">&#39;ресторан «хинкальная»&#39;</span>, <span class="st">&#39;хинкальная на арме&#39;</span>, <span class="st">&#39;хинкальная салхино&#39;</span>, <span class="st">&#39;хинкальная кера&#39;</span>, <span class="st">&#39;хинкальная батоно&#39;</span>, <span class="st">&#39;вах хинкальная&#39;</span>],</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;якитория&#39;</span>:[<span class="st">&#39;ресторан «якитория»&#39;</span>, <span class="st">&#39;кафе «якитория»&#39;</span>, <span class="st">&#39;якитория&#39;</span>, <span class="st">&#39;якитория и ян примус&#39;</span>, <span class="st">&#39;кафе якитория&#39;</span>, <span class="st">&#39;якитория и спорт бар&#39;</span>],</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>         <span class="st">&#39;иль патио&#39;</span>:[<span class="st">&#39;иль патио&#39;</span>, <span class="st">&#39;иль патио планета суши&#39;</span>, <span class="st">&#39;ресторан «иль патио»&#39;</span>, <span class="st">&#39;шикари иль патио&#39;</span>, <span class="st">&#39;кафе иль патио «il patio»&#39;</span>, <span class="st">&#39;ресторан планета суши иль патио&#39;</span>, <span class="st">&#39;кафе «иль патио»&#39;</span>,<span class="st">&#39;иль-патио&#39;</span>]}</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="8">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dic_unique_name(data):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">list</span><span class="op">=</span>{}</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    seasrch_name <span class="op">=</span> [<span class="st">&#39;шоколадница&#39;</span>, <span class="st">&#39;макдон&#39;</span>, <span class="st">&#39;бургер кинг&#39;</span>, <span class="st">&#39;bb burgers&#39;</span>,<span class="st">&#39;black star&#39;</span>, <span class="st">&#39;coffee moose&#39;</span>, <span class="st">&#39;cofix&#39;</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;dim sum&#39;</span>, <span class="st">&#39;вареничная&#39;</span>, <span class="st">&#39;волконский&#39;</span>, <span class="st">&#39;суши сет&#39;</span>, <span class="st">&#39;суши wok&#39;</span>, <span class="st">&#39;тратория&#39;</span>,<span class="st">&#39;столовая школа&#39;</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;хинкальная&#39;</span>,<span class="st">&#39;якитория&#39;</span>,<span class="st">&#39;иль патио&#39;</span>]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name <span class="kw">in</span> seasrch_name:</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> (data[data[<span class="st">&#39;object_name&#39;</span>].<span class="bu">str</span>.contains(name)][<span class="st">&#39;object_name&#39;</span>]).unique().tolist()</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        <span class="bu">list</span>[name] <span class="op">=</span> x</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>dic_unique_name <span class="op">=</span> dic_unique_name(data)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>dic_unique_name</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<pre><code>{&#39;шоколадница&#39;: [&#39;шоколадница&#39;,
  &#39;шоколадница кофе хаус&#39;,
  &#39;кофейня «шоколадница»&#39;,
  &#39;кафе «шоколадница»&#39;,
  &#39;кофейня шоколадница&#39;,
  &#39;шоколадница экспресс&#39;,
  &#39;шоколадница кофемания&#39;],
 &#39;макдон&#39;: [&#39;макдоналдс&#39;,
  &#39;ресторан «макдоналдс»&#39;,
  &#39;предприятие быстрого обслуживания «макдоналдс»&#39;,
  &#39;москва - макдоналдс&#39;,
  &#39;кафе макдоналдс&#39;,
  &#39;кафе «макдоналдс»&#39;,
  &#39;ресторан«макдоналдс»&#39;],
 &#39;бургер кинг&#39;: [&#39;ресторан «бургер кинг»&#39;,
  &#39;бургер кинг&#39;,
  &#39;предприятие быстрого обслуживания «бургер кинг»&#39;,
  &#39;бургер кинг burger king&#39;,
  &#39;кафе бургер кинг&#39;,
  &#39;закусочная «бургер кинг»&#39;,
  &#39;кафе-закусочная «бургер кинг»&#39;,
  &#39;кафе «бургер кинг»&#39;],
 &#39;bb burgers&#39;: [&#39;ресторан «bb burgers»&#39;],
 &#39;black star&#39;: [&#39;black star burgers&#39;,
  &#39;black star burger prime&#39;,
  &#39;black star burger&#39;],
 &#39;coffee moose&#39;: [&#39;coffee moose&#39;,
  &#39;кафе «coffee moose»&#39;,
  &#39;coffee moose кофейня&#39;],
 &#39;cofix&#39;: [&#39;cofix&#39;,
  &#39;cofix-bright&#39;,
  &#39;кофейня «cofix»&#39;,
  &#39;кофейня cofix&#39;,
  &#39;cofix+plombir&#39;],
 &#39;dim sum&#39;: [&#39;dim sum &amp; co&#39;,
  &#39;кафе dim sum &amp; c0&#39;,
  &#39;ресторан «dim sum &amp; co»&#39;,
  &#39;dim sum&#39;,
  &#39;dim sum&amp;co&#39;],
 &#39;вареничная&#39;: [&#39;вареничная №1&#39;,
  &#39;вареничная № 1&#39;,
  &#39;вареничная&#39;,
  &#39;ресторан «вареничная №1»&#39;,
  &#39;вареничная (хинкальная)&#39;,
  &#39;кафе «вареничная №1»&#39;,
  &#39;вареничная 1&#39;],
 &#39;волконский&#39;: [&#39;волконский&#39;,
  &#39;кондитерская волконский&#39;,
  &#39;волконский у дома&#39;,
  &#39;кондитерская-пекарня волконский&#39;,
  &#39;пекарня «волконский хлеб»&#39;,
  &#39;пекарня волконский&#39;,
  &#39;кафе «волконский»&#39;,
  &#39;кафе волконский пекарня&#39;,
  &#39;кафе-пекарея «волконский»&#39;],
 &#39;суши сет&#39;: [&#39;суши сет&#39;, &#39;кафе «суши сет»&#39;, &#39;магазин-кулинария «суши сет»&#39;],
 &#39;суши wok&#39;: [&#39;суши wok&#39;,
  &#39;сеть магазинов «суши wok»&#39;,
  &#39;кафе суши wok&#39;,
  &#39;кафе «суши wok»&#39;,
  &#39;бар «суши wok»&#39;],
 &#39;тратория&#39;: [&#39;тратория semplice&#39;,
  &#39;тратория&#39;,
  &#39;тратория italian «паста&amp;пицца»&#39;],
 &#39;столовая школа&#39;: [&#39;столовая школа 58&#39;,
  &#39;столовая школа 98&#39;,
  &#39;столовая школа 1543&#39;,
  &#39;столовая школа «уна»&#39;,
  &#39;столовая школа «наши традиции»&#39;,
  &#39;столовая школа 38&#39;,
  &#39;столовая школа 37&#39;,
  &#39;столовая школа 14 (598)&#39;,
  &#39;столовая школа 14&#39;,
  &#39;столовая школа 74&#39;,
  &#39;столовая школа 571&#39;,
  &#39;столовая школа 1118&#39;,
  &#39;столовая школа 97&#39;,
  &#39;столовая школа 537 «комбинат дошкольного питания»&#39;,
  &#39;столовая школа 29&#39;,
  &#39;столовая школа 1485&#39;,
  &#39;столовая школа 875&#39;,
  &#39;столовая школа 875 (807)&#39;,
  &#39;столовая школа 803&#39;,
  &#39;столовая школа 73&#39;,
  &#39;столовая школа 99&#39;,
  &#39;столовая школа 262&#39;,
  &#39;столовая школа 71&#39;,
  &#39;столовая школа 261&#39;,
  &#39;столовая школа 804&#39;,
  &#39;столовая школа 712&#39;,
  &#39;столовая школа 79&#39;,
  &#39;столовая школа 84&#39;,
  &#39;столовая школа 1738&#39;,
  &#39;столовая школа 1741&#39;,
  &#39;столовая школа 1498&#39;,
  &#39;столовая школа 1905&#39;,
  &#39;столовая школа-интернат №15 циркового профиля им. ю.в. никулина для детей, оставшихся без попечения&#39;,
  &#39;столовая школа 1941&#39;,
  &#39;столовая школа 843 (812)&#39;,
  &#39;столовая школа 1448&#39;,
  &#39;столовая школа структурное подразделение №2 гбоу школы 2025&#39;,
  &#39;столовая школа 843&#39;,
  &#39;столовая школа 1248&#39;,
  &#39;столовая школа 916&#39;,
  &#39;столовая школа 1485 (созвездие)&#39;,
  &#39;столовая школа №939&#39;,
  &#39;столовая школа №937&#39;,
  &#39;столовая школа № 937&#39;],
 &#39;хинкальная&#39;: [&#39;кафе «хинкальная»&#39;,
  &#39;хинкальная&#39;,
  &#39;хинкальная city&#39;,
  &#39;хинкальная (на м. бирюзова)&#39;,
  &#39;кафе хинкальная&#39;,
  &#39;хинкальная виноград&#39;,
  &#39;цинандали хинкальная&#39;,
  &#39;хинкальная 777&#39;,
  &#39;кафе хинкальная саамо&#39;,
  &#39;хинкальная «кахури»&#39;,
  &#39;хинкальная у бехо&#39;,
  &#39;хинкальная №1&#39;,
  &#39;мимино хинкальная&#39;,
  &#39;хинкальная кинто&#39;,
  &#39;хинкальная на спасской&#39;,
  &#39;хинкальная, пекарня&#39;,
  &#39;кафе хинкальная 11&#39;,
  &#39;хинкальная №5&#39;,
  &#39;хинкальная кахетия&#39;,
  &#39;кафе хинкальная грузинская кухня&#39;,
  &#39;ресторан хинкальная&#39;,
  &#39;хинкальная чела&#39;,
  &#39;новая хинкальная&#39;,
  &#39;хинкальная.джи&#39;,
  &#39;хинкальная батони&#39;,
  &#39;хинкальная № 1&#39;,
  &#39;m cafe хинкальная&#39;,
  &#39;marrakesh хинкальная&#39;,
  &#39;у михалыча хинкальная №1&#39;,
  &#39;грузинская кухня эzо хинкальная&#39;,
  &#39;вареничная (хинкальная)&#39;,
  &#39;ресторан «хинкальная»&#39;,
  &#39;хинкальная на арме&#39;,
  &#39;хинкальная салхино&#39;,
  &#39;хинкальная кера&#39;,
  &#39;хинкальная батоно&#39;,
  &#39;вах хинкальная&#39;],
 &#39;якитория&#39;: [&#39;ресторан «якитория»&#39;,
  &#39;кафе «якитория»&#39;,
  &#39;якитория&#39;,
  &#39;якитория и ян примус&#39;,
  &#39;кафе якитория&#39;,
  &#39;якитория и спорт бар&#39;],
 &#39;иль патио&#39;: [&#39;иль патио&#39;,
  &#39;иль патио планета суши&#39;,
  &#39;ресторан «иль патио»&#39;,
  &#39;шикари иль патио&#39;,
  &#39;кафе иль патио «il patio»&#39;,
  &#39;ресторан планета суши иль патио&#39;,
  &#39;кафе «иль патио»&#39;]}</code></pre>
</div>
</div>
<div class="cell markdown">
<p><font color='red'> После этого добавим новый столбец с унифицированным именем объекта - для тех заведений, у которых есть несколько вариантов названия. Если заведение в выборке одно - ставим None. Делаю это для того, чтобы потом по стобцу new_name убрать дубликаты. Ведь если значение None - повторов итак нет.</p>
</div>
<div class="cell code" data-execution_count="9">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> new_name(seasrch_name):</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key, value <span class="kw">in</span> dict_.items():</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> seasrch_name <span class="kw">in</span> value:</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> key</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>data[<span class="st">&#39;new_name&#39;</span>] <span class="op">=</span> data.object_name.<span class="bu">apply</span>(new_name)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>data.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>object_name</th>
      <th>chain</th>
      <th>object_type</th>
      <th>address</th>
      <th>number</th>
      <th>new_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>151635</td>
      <td>сметана</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, улица Егора Абакумова, дом 9</td>
      <td>48</td>
      <td>None</td>
    </tr>
    <tr>
      <td>1</td>
      <td>77874</td>
      <td>родник</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, улица Талалихина, дом 2/1, корпус 1</td>
      <td>35</td>
      <td>None</td>
    </tr>
    <tr>
      <td>2</td>
      <td>24309</td>
      <td>кафе «академия»</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, Абельмановская улица, дом 6</td>
      <td>95</td>
      <td>None</td>
    </tr>
    <tr>
      <td>3</td>
      <td>21894</td>
      <td>пиццетория</td>
      <td>да</td>
      <td>кафе</td>
      <td>город Москва, Абрамцевская улица, дом 1</td>
      <td>40</td>
      <td>None</td>
    </tr>
    <tr>
      <td>4</td>
      <td>119365</td>
      <td>кафе «вишневая метель»</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, Абрамцевская улица, дом 9, корпус 1</td>
      <td>50</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Уберем дубликаты из датасета для дальнейшего анализа данных (используюстолбец с новыми названиями объектов, адресом и посадочными местами).</p>
</div>
<div class="cell code" data-execution_count="10">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data_new <span class="op">=</span> data.drop_duplicates(subset<span class="op">=</span>[<span class="st">&#39;new_name&#39;</span>,<span class="st">&#39;address&#39;</span>,<span class="st">&#39;number&#39;</span>], keep<span class="op">=</span><span class="st">&quot;first&quot;</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data_new = data[[&#39;object_name&#39;, &#39;new_name&#39;]].dropna().drop_duplicates()</span></span></code></pre></div>
</div>
<div class="cell code" data-execution_count="11">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 15366 entries, 0 to 15365
Data columns (total 7 columns):
id             15366 non-null int64
object_name    15366 non-null object
chain          15366 non-null object
object_type    15366 non-null object
address        15366 non-null object
number         15366 non-null int64
new_name       968 non-null object
dtypes: int64(2), object(5)
memory usage: 840.5+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="12">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>data_new.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 13818 entries, 0 to 15365
Data columns (total 7 columns):
id             13818 non-null int64
object_name    13818 non-null object
chain          13818 non-null object
object_type    13818 non-null object
address        13818 non-null object
number         13818 non-null int64
new_name       966 non-null object
dtypes: int64(2), object(5)
memory usage: 863.6+ KB
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Дубликатов больше нет, далее можно использовать в работе названия объектов из столбца object_name.</p>
</div>
<div class="cell code" data-execution_count="13">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data_new.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>object_name</th>
      <th>chain</th>
      <th>object_type</th>
      <th>address</th>
      <th>number</th>
      <th>new_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>151635</td>
      <td>сметана</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, улица Егора Абакумова, дом 9</td>
      <td>48</td>
      <td>None</td>
    </tr>
    <tr>
      <td>1</td>
      <td>77874</td>
      <td>родник</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, улица Талалихина, дом 2/1, корпус 1</td>
      <td>35</td>
      <td>None</td>
    </tr>
    <tr>
      <td>2</td>
      <td>24309</td>
      <td>кафе «академия»</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, Абельмановская улица, дом 6</td>
      <td>95</td>
      <td>None</td>
    </tr>
    <tr>
      <td>3</td>
      <td>21894</td>
      <td>пиццетория</td>
      <td>да</td>
      <td>кафе</td>
      <td>город Москва, Абрамцевская улица, дом 1</td>
      <td>40</td>
      <td>None</td>
    </tr>
    <tr>
      <td>4</td>
      <td>119365</td>
      <td>кафе «вишневая метель»</td>
      <td>нет</td>
      <td>кафе</td>
      <td>город Москва, Абрамцевская улица, дом 9, корпус 1</td>
      <td>50</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="шаг-2-анализ-данных" class="cell markdown">
<h2>Шаг №2. Анализ данных</h2>
</section>
<div class="cell markdown">
<p><font color='06623b'> После того, как данные приведены к нужному типу и удалены дубликаты, можно начать анализировать данные для получения конкретных выводов.</p>
<p><font color='06623b'> Посмотрим, как соотносятся виды объектов общественного питания по количеству и покажем результаты на графике.</p>
<p><font color='06623b'> Так как в дальнейшем прийдется часто визуализировать данные, напишем функцию горизонтальной гистограммы (не прийдется в дальнейшем приводить графики к одному стилю).</p>
</div>
<div class="cell code" data-execution_count="14">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hist(x,y, data, title, color):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(x,y))        <span class="co"># размер графика</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    ax.barh(data.iloc[:,<span class="dv">0</span>], data.iloc[:,<span class="dv">1</span>], color<span class="op">=</span>color) <span class="co"># горизонтальный bar по данным + задаем цвет</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    ax.set_title(title, loc<span class="op">=</span><span class="st">&#39;left&#39;</span>, pad<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&quot;bold&quot;</span>)   <span class="co"># заголовок графика + задаем шрифт</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> s <span class="kw">in</span> [<span class="st">&#39;top&#39;</span>,<span class="st">&#39;bottom&#39;</span>,<span class="st">&#39;left&#39;</span>,<span class="st">&#39;right&#39;</span>]:                    <span class="co"># убираю все границы графика</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        ax.spines[s].set_visible(<span class="va">False</span>)                          </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    ax.grid(b<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;grey&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-.&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)  <span class="co"># задаю только промежуточные границы по значениям</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> ax.patches:                                                     <span class="co"># цикл по значениям</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        ax.text(i.get_width()<span class="op">+</span><span class="dv">2</span>, i.get_y()<span class="op">+</span><span class="fl">0.5</span>, <span class="bu">str</span>(<span class="bu">round</span>((i.get_width()), <span class="dv">2</span>)),   <span class="co"># задаю отступ (+) для подписи</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, color<span class="op">=</span><span class="st">&#39;grey&#39;</span>)                     <span class="co"># задаю шрифт и цвет подписи значения</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    plt.show() </span></code></pre></div>
</div>
<div class="cell code" data-execution_count="15" data-scrolled="false">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># соотношение видов объектов общественного питания по количеству</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>obj_top10 <span class="op">=</span> (data_new.groupby([<span class="st">&#39;object_type&#39;</span>]).agg({<span class="st">&#39;id&#39;</span>:<span class="st">&#39;nunique&#39;</span>}).reset_index()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     .sort_values(<span class="st">&#39;id&#39;</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> hist(<span class="dv">13</span>,<span class="dv">5</span>, obj_top10.sort_values(<span class="st">&#39;id&#39;</span>), </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">&#39;Cоотношение видов объектов общественного питания по количеству (top-10)&#39;</span>, <span class="st">&#39;sienna&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/52c2a061e13df025b4ef5078c9973e50242ea612.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Самый популярный вид объекта - кафе (в общей сложности по анализируемой территории из более 6 тысяч), почти в половину меньше столовых и ресторанов. Меньше всего открывают магазинов с отделами кулинарии.</p>
</div>
<div class="cell markdown">
<p><font color='06623b'> Если говорить про распределение сетевых и несетевых объектов по анализируемой территории, результат следующий:</p>
</div>
<div class="cell code" data-execution_count="16">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  соотношение сетевых и несетевых заведений по количеству</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>chain_top <span class="op">=</span> data_new.groupby([<span class="st">&#39;chain&#39;</span>]).agg({<span class="st">&#39;id&#39;</span>:<span class="st">&#39;nunique&#39;</span>}).reset_index()</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> chain_top.chain.tolist()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>sizes <span class="op">=</span> chain_top.<span class="bu">id</span>.tolist()</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">&#39;navajowhite&#39;</span>, <span class="st">&#39;peru&#39;</span>]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>ax.pie(sizes, labels<span class="op">=</span>labels, autopct<span class="op">=</span><span class="st">&#39;</span><span class="sc">%1.1f%%</span><span class="st">&#39;</span>, colors <span class="op">=</span> colors)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>ax.axis(<span class="st">&#39;equal&#39;</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Соотношение сетевых и несетевых заведений по количеству&#39;</span>, pad<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&quot;bold&quot;</span>, loc<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">
<pre><code>Text(0.0, 1.0, &#39;Соотношение сетевых и несетевых заведений по количеству&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/024aa1d01c0c062e40bd0c91e221d07271cf9e55.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> В столице и её пределах наиболее развиты несетевые заведения (80.7% от общего количества). Это значит, что подавляющее большинство объектов имеют менее 2-3 заведений одной сети.</p>
</div>
<div class="cell markdown">
<p><font color='06623b'> А какие объекты считаются сетевыми? Посмотрим на графике:</p>
</div>
<div class="cell code" data-execution_count="17">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># для какого вида объекта общественного питания характерно сетевое распространение</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>chain_type_top <span class="op">=</span> (data_new.query(<span class="st">&#39;chain == &quot;да&quot;&#39;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                  .groupby([<span class="st">&#39;object_type&#39;</span>]).agg({<span class="st">&#39;id&#39;</span>:<span class="st">&#39;nunique&#39;</span>})</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                  .reset_index().sort_values(<span class="st">&#39;id&#39;</span>, ascending <span class="op">=</span> <span class="va">False</span>))</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="18">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>chain_type_top1 <span class="op">=</span> data_new.pivot_table(index<span class="op">=</span>[<span class="st">&#39;object_type&#39;</span>],</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                                       columns<span class="op">=</span><span class="st">&#39;chain&#39;</span>, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                                       values<span class="op">=</span><span class="st">&#39;id&#39;</span>, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                                       aggfunc<span class="op">=</span>[<span class="st">&#39;count&#39;</span>], </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                                       margins<span class="op">=</span><span class="va">True</span>).reset_index()</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>chain_type_top1.columns <span class="op">=</span> [<span class="st">&#39;object_type&#39;</span>, <span class="st">&#39;chain&#39;</span>, <span class="st">&#39;not_chain&#39;</span>, <span class="st">&#39;total&#39;</span>]</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>chain_type_top1[<span class="st">&#39;chain_perc&#39;</span>] <span class="op">=</span> <span class="bu">round</span>(chain_type_top1[<span class="st">&#39;chain&#39;</span>] <span class="op">/</span> chain_type_top1[<span class="st">&#39;total&#39;</span>] <span class="op">*</span> <span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>chain_type_top1[<span class="st">&#39;no_chain_perc&#39;</span>] <span class="op">=</span> <span class="bu">round</span>(chain_type_top1[<span class="st">&#39;not_chain&#39;</span>] <span class="op">/</span> chain_type_top1[<span class="st">&#39;total&#39;</span>]<span class="op">*</span> <span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> chain_type_top1[[<span class="st">&#39;object_type&#39;</span>,<span class="st">&#39;chain_perc&#39;</span>,<span class="st">&#39;no_chain_perc&#39;</span>]].melt(id_vars<span class="op">=</span>[<span class="st">&#39;object_type&#39;</span>], </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>                                                                       var_name<span class="op">=</span>[<span class="st">&#39;type_chain&#39;</span>], </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                                                                       value_name<span class="op">=</span><span class="st">&#39;perc&#39;</span>).sort_values(<span class="st">&#39;perc&#39;</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&quot;perc&quot;</span>, y<span class="op">=</span><span class="st">&quot;object_type&quot;</span>, hue <span class="op">=</span><span class="st">&#39;type_chain&#39;</span>, data<span class="op">=</span>a, palette<span class="op">=</span><span class="st">&#39;YlOrBr&#39;</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>ax.legend(ncol<span class="op">=</span><span class="dv">2</span>, loc<span class="op">=</span><span class="st">&quot;lower right&quot;</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(ylabel<span class="op">=</span><span class="st">&quot;&quot;</span>, xlabel<span class="op">=</span><span class="st">&quot;Доля типа заведения, в %&quot;</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Распределение сетевых и несетевых заведений по типам, в %&#39;</span>, loc<span class="op">=</span><span class="st">&#39;left&#39;</span>, pad<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>sns.despine(left<span class="op">=</span><span class="va">True</span>, bottom<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> [<span class="st">&#39;top&#39;</span>,<span class="st">&#39;bottom&#39;</span>,<span class="st">&#39;left&#39;</span>,<span class="st">&#39;right&#39;</span>]:                   </span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    ax.spines[s].set_visible(<span class="va">False</span>)                          </span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>ax.grid(b<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;grey&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-.&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)  </span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> ax.patches:                                                     </span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    ax.text(i.get_width()<span class="op">+</span><span class="dv">2</span>, i.get_y()<span class="op">+</span><span class="fl">0.3</span>, <span class="bu">str</span>(<span class="bu">round</span>((i.get_width()), <span class="dv">2</span>)), </span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>                fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, color<span class="op">=</span><span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/d7481b29146373ed982e2d19415543769d4fc118.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Как и отмечалось ранее, самый часто встречающийся сетевой тип объекта - предприятия быстрого обслуживания.</p>
<p><font color='06623b'> По графику видно, что у столовых, буфетов и баров самый низкий процент сетевых заведений (то есть их почти нет).</p>
<p><font color='06623b'> Чтобы понять, характерно ли для сетевых заведений большое или маленькое количество посадочных мест, а так же их распределение по количеству, посмотрим среднее распределение и выведем результаты на графики.</p>
<p><font color='06623b'> Для этого прежде всего найдем топовые (10) сетевые заведения и посмотрим, как часто они встречаются и с каким количеством посадочных мест.</p>
</div>
<div class="cell code" data-execution_count="19">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Что характерно для сетевых заведений: много заведений с небольшим числом посадочных мест в каждом или </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># мало заведений с большим количеством посадочных мест?</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>chain_name_top <span class="op">=</span> (data_new.query(<span class="st">&#39;chain == &quot;да&quot;&#39;</span>).groupby([<span class="st">&#39;object_name&#39;</span>]).agg({<span class="st">&#39;id&#39;</span>:<span class="st">&#39;nunique&#39;</span>}).reset_index()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>     .sort_values(<span class="st">&#39;id&#39;</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>))[<span class="st">&#39;object_name&#39;</span>].to_list()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>report <span class="op">=</span> data_new[data_new[<span class="st">&#39;object_name&#39;</span>].isin(chain_name_top)][[<span class="st">&#39;object_name&#39;</span>,<span class="st">&#39;number&#39;</span>]]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">4</span>))</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> [<span class="st">&#39;top&#39;</span>,<span class="st">&#39;bottom&#39;</span>,<span class="st">&#39;left&#39;</span>,<span class="st">&#39;right&#39;</span>]:                    </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>        ax.spines[s].set_visible(<span class="va">False</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>ax.grid(b<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;grey&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-.&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.barplot(x<span class="op">=</span><span class="st">&#39;object_name&#39;</span>, y <span class="op">=</span> <span class="st">&#39;number&#39;</span>, data <span class="op">=</span> report.sort_values(<span class="st">&#39;number&#39;</span>, ascending <span class="op">=</span> <span class="va">False</span>), </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                 order = [&#39;макдоналдс&#39;, &#39;шоколадница&#39;,&#39;kfc&#39;,&#39;бургер кинг&#39;,&#39;теремок&#39;,&#39;папа джонс&#39;,</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="co">#                          &#39;крошка картошка&#39;,&#39;суши wok&#39;,&#39;милти&#39;,&#39;домино&#39;&#39;c пицца&#39;],</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                palette<span class="op">=</span><span class="st">&#39;YlOrBr&#39;</span>).set_title(<span class="st">&#39;Среднее значение посадочных мест сетевых заведений&#39;</span>, </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                                             loc<span class="op">=</span><span class="st">&#39;left&#39;</span>, pad<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="va">None</span>, ylabel<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/3fd98a09ff6ffb661bf4db22b8d1568baf124134.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Самое большое среднее число посадочных мест у сетевого ресторана - более 90, маленькое - около 10.</p>
<p><font color='06623b'> Если усреднить показатели всех объектов, то примем за границу деления - 60 посадочных мест.</p>
<p><font color='red'> Сделала сортировку данных по количеству посадочных мест (столбец number)</p>
</div>
<div class="cell code" data-execution_count="20">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>report[<span class="st">&#39;less 60&#39;</span>] <span class="op">=</span> report[<span class="st">&#39;number&#39;</span>] <span class="op">&lt;=</span> <span class="dv">60</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>report[<span class="st">&#39;over 60&#39;</span>] <span class="op">=</span> report[<span class="st">&#39;number&#39;</span>] <span class="op">&gt;</span> <span class="dv">60</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>report_last <span class="op">=</span> (report.groupby([<span class="st">&#39;object_name&#39;</span>]).agg({<span class="st">&#39;number&#39;</span>:<span class="st">&#39;count&#39;</span>, <span class="st">&#39;less 60&#39;</span>:<span class="st">&#39;sum&#39;</span>, <span class="st">&#39;over 60&#39;</span>:<span class="st">&#39;sum&#39;</span>}).reset_index())</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>report_last[<span class="st">&#39;less_perc&#39;</span>] <span class="op">=</span> report_last[<span class="st">&#39;less 60&#39;</span>] <span class="op">/</span> report_last[<span class="st">&#39;number&#39;</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>report_last[<span class="st">&#39;over_perc&#39;</span>] <span class="op">=</span> report_last[<span class="st">&#39;over 60&#39;</span>] <span class="op">/</span> report_last[<span class="st">&#39;number&#39;</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span>report_last[[<span class="st">&#39;object_name&#39;</span>,<span class="st">&#39;less_perc&#39;</span>,<span class="st">&#39;over_perc&#39;</span>]].melt(id_vars<span class="op">=</span>[<span class="st">&#39;object_name&#39;</span>], </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                                                          var_name<span class="op">=</span>[<span class="st">&#39;count_number&#39;</span>], </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                                                          value_name<span class="op">=</span><span class="st">&#39;perc&#39;</span>).sort_values(<span class="st">&#39;perc&#39;</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">8</span>))</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">&quot;perc&quot;</span>, y<span class="op">=</span><span class="st">&quot;object_name&quot;</span>, hue <span class="op">=</span><span class="st">&#39;count_number&#39;</span>, data<span class="op">=</span>b, palette<span class="op">=</span><span class="st">&#39;YlOrBr&#39;</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>ax.legend(ncol<span class="op">=</span><span class="dv">2</span>, loc<span class="op">=</span><span class="st">&quot;lower right&quot;</span>, frameon<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(ylabel<span class="op">=</span><span class="st">&quot;&quot;</span>, xlabel<span class="op">=</span><span class="st">&quot;Доля заведения, в %&quot;</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Посадочные места сетевых заведений (менее и более 60 посадочных мест), в %&#39;</span>, </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>             loc<span class="op">=</span><span class="st">&#39;left&#39;</span>, pad<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>sns.despine(left<span class="op">=</span><span class="va">True</span>, bottom<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> [<span class="st">&#39;top&#39;</span>,<span class="st">&#39;bottom&#39;</span>,<span class="st">&#39;left&#39;</span>,<span class="st">&#39;right&#39;</span>]:                   </span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    ax.spines[s].set_visible(<span class="va">False</span>)                          </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>ax.grid(b<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">&#39;grey&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-.&#39;</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">0.2</span>)  </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> ax.patches:                                                     </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    ax.text(i.get_width()<span class="op">+</span><span class="dv">2</span>, i.get_y()<span class="op">+</span><span class="fl">0.3</span>, <span class="bu">str</span>(<span class="bu">round</span>((i.get_width()), <span class="dv">2</span>)), </span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>                fontsize<span class="op">=</span><span class="dv">10</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, color<span class="op">=</span><span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/fa4df5a65a0d7a4e4398932cf5f2a1773a2ab99e.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Вот и ответ на вопрос: сетевые заведения в большинстве случаев имееют много заведений с небольшим количеством посадочных мест. Конечно, все зависит от территории размещения заведения, но как и логично предположить, что конкуренция не позволяет быть "монополистом" в большом молле - каждый раз приходя в любой торговый центр, обычно можно встретить все популярные сетевые заведения.</p>
<p><font color='06623b'></p>
</div>
<div class="cell markdown">
<p><font color='06623b'> Посмотрим, какое среднее количество посадочных мест у каждого типа заведения. Посмотрим результаты на графике.</p>
</div>
<div class="cell code" data-execution_count="21">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Для каждого вида объекта общественного питания опишите среднее количество посадочных мест. </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Какой вид предоставляет в среднем самое большое количество посадочных мест?</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>number_type_top <span class="op">=</span> data_new.groupby([<span class="st">&#39;object_type&#39;</span>]).agg({<span class="st">&#39;number&#39;</span>:<span class="st">&#39;mean&#39;</span>}).reset_index().sort_values(<span class="st">&#39;number&#39;</span>, ascending <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>hist(<span class="dv">15</span>,<span class="dv">5</span>,number_type_top , <span class="st">&#39;Посадочные места сетевых заведений&#39;</span>, <span class="st">&#39;olive&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/759a48176e3b098cd91626862a66d02c6e44584c.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Столовые вмещают в себя самое большое количество желающих (около 130 человек в одном заведении). Это объясняется относительной дешевизной блюд, а следовательно, и доступностью для каждого жителя Москвы.</p>
<p><font color='06623b'> Далее идут рестораны, которые в среднем могут усадить до 100 человек в одном заведении.</p>
<p><font color='06623b'> Буфет в среднем может предложить около 50 посадочных мест - такое заведение в большинстве случаем не предполагает длительное посещение людей.</p>
<p><font color='06623b'> А вот бар может предложить свои услуги в среднем для 40 людей - объясняется тем, что не все проводят пятничный вечер за бокалом вина :-)</p>
</div>
<div class="cell markdown">
<p><font color='06623b'> Для того, чтобы провести детальный анализ, выделим в отдельный столбец информацию об улице объекта.</p>
<p><font color='06623b'> Выделение улицы делаем с помощь регулярного выражения.</p>
</div>
<div class="cell code" data-execution_count="22">
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Выделите в отдельный столбец информацию об улице из столбца address</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pattern <span class="op">=</span> <span class="st">&#39;\,(([а-яА-Я0-9\-ё\s&quot;]+)?(аллея|бульвар|деревня|квартал|километр|корпус|линия|микрорайон|набережная|переулок|площадь|посёлок|проезд|просек|проспект|территория|тупик|улица|шоссе|село)([а-яА-Яё0-9\-\s&quot;]+)?)\,&#39;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>data_new[<span class="st">&#39;street&#39;</span>] <span class="op">=</span> data_new[<span class="st">&#39;address&#39;</span>].<span class="bu">str</span>.extract(pat <span class="op">=</span> pattern)[<span class="dv">0</span>]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>data_new[[<span class="st">&#39;address&#39;</span>, <span class="st">&#39;street&#39;</span>]].query(<span class="st">&#39;street.isna()&#39;</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">#\, - кусок строки должен начинаться с запятой и заканчиваться запятой</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">#((.+)?(улица|переулок|шоссе)(.+)?) - т.н. capture group - то, что будет извлекаться</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">#здесь</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">#(.+)? - опциональный (поэтому ?) кусок строки, содержащий любые символы</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">#(улица|переулок|шоссе) - слово &quot;улица&quot; или &quot;переулок&quot; или &quot;шоссе&quot;</span></span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:4: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  after removing the cwd from sys.path.
</code></pre>
</div>
<div class="output execute_result" data-execution_count="22">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>address</th>
      <th>street</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>859</td>
      <td>Партизанская улица, дом 30</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1405</td>
      <td>город Москва, город Зеленоград, корпус 401</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1406</td>
      <td>город Москва, город Зеленоград, корпус 435</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1407</td>
      <td>город Москва, город Зеленоград, корпус 436</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1408</td>
      <td>город Москва, город Зеленоград, корпус 438</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>14470</td>
      <td>город Москва, город Зеленоград, корпус 1627</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>14473</td>
      <td>город Москва, город Зеленоград, корпус 1602А</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>14478</td>
      <td>город Москва, город Зеленоград, корпус 532</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>15137</td>
      <td>город Москва, город Зеленоград, Проезд № 4806,...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>15184</td>
      <td>город Москва, город Зеленоград, корпус 1627</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>196 rows × 2 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Все, что не найдено (выведено вверху) - в большинстве случаев - город Зеленоград, который в дальнейшем анализе не участвует. Поэтому 198 записями можно пренебречь.</p>
<p><font color='06623b'> Построим график топ-10 улиц по количеству объектов общественного питания. А еще посмотрим, в каких районах находятся данные улицы.</p>
</div>
<div class="cell code" data-execution_count="23" data-scrolled="true">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>street_top <span class="op">=</span> (data_new.groupby([<span class="st">&#39;street&#39;</span>]).agg({<span class="st">&#39;id&#39;</span>:<span class="st">&#39;nunique&#39;</span>}).reset_index().sort_values(<span class="st">&#39;id&#39;</span>, ascending <span class="op">=</span> <span class="va">False</span>).head(<span class="dv">10</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>hist(<span class="dv">15</span>,<span class="dv">5</span>,street_top.sort_values(<span class="st">&#39;id&#39;</span>, ascending <span class="op">=</span> <span class="va">True</span>), <span class="st">&#39;Top-10 улиц по количеству объектов общественного питания&#39;</span>, <span class="st">&#39;sienna&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/b3485f28db9945a1889120bdf34832114f8f0166.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color=' 06623b'> Для этого можно использовать несколько вариантов.</p>
<p><font color='06623b'> Во-первых, я использую пакет для геолокации (folium), чтобы отметить все объекты из топового списка (выше) на карте. К сожалению, тренажер не позволяет вывести результат, поэтому я сохранила его в расширении *.html локально на компьютере, а сюда вставила объект для вывода.</p>
<p><font color='red'> Надем районы, через которые чаще всего проходят топовские улицы (ares - top_house). Они и отмечаны на карте.</p>
</div>
<div class="cell code" data-execution_count="25" data-scrolled="false">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Надем районы, через которые чаще всего проходят топовские улицы</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>data_new.address.replace(<span class="st">&quot;владение&quot;</span>,<span class="st">&quot;дом&quot;</span>).replace(<span class="st">&#39;домовладение&#39;</span>, <span class="st">&#39;дом&#39;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>data_new[<span class="st">&#39;house&#39;</span>] <span class="op">=</span> data_new[<span class="st">&#39;address&#39;</span>].<span class="bu">str</span>.rpartition(<span class="st">&#39;, дом &#39;</span>)[<span class="dv">2</span>]  </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>top_house <span class="op">=</span> (data_new[data_new[<span class="st">&#39;street&#39;</span>].isin(street_top[<span class="st">&#39;street&#39;</span>].<span class="bu">str</span>.strip().unique().tolist())]</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                                        .groupby([<span class="st">&#39;street&#39;</span>,<span class="st">&#39;house&#39;</span>])</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>                                        .agg({<span class="st">&#39;id&#39;</span>:<span class="st">&#39;nunique&#39;</span>})</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>                                        .reset_index()</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                                        .sort_values(<span class="st">&#39;id&#39;</span>, ascending <span class="op">=</span> <span class="va">False</span>))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>top_house <span class="op">=</span> top_house.groupby([<span class="st">&#39;street&#39;</span>]).agg({<span class="st">&#39;house&#39;</span>:<span class="st">&#39;max&#39;</span>,<span class="st">&#39;id&#39;</span>:<span class="st">&#39;max&#39;</span>}).reset_index()</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>top_house[<span class="st">&#39;area&#39;</span>] <span class="op">=</span> [<span class="st">&#39;квартал № 123&#39;</span>,</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;район Москворечье-Сабурово&#39;</span>,</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;район Чертаново Центральное&#39;</span>,</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;район Фили-Давыдково&#39;</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;Хорошёвский район&#39;</span>,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;Обручевский район&#39;</span>,</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;Пресненский район&#39;</span>,</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;район Коньково&#39;</span>,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;район Раменки&#39;</span>,</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&#39;Останкинский район&#39;</span>]</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>top_house.area</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  This is separate from the ipykernel package so we can avoid doing imports until
</code></pre>
</div>
<div class="output execute_result" data-execution_count="25">
<pre><code>0                  квартал № 123
1     район Москворечье-Сабурово
2    район Чертаново Центральное
3           район Фили-Давыдково
4              Хорошёвский район
5              Обручевский район
6              Пресненский район
7                 район Коньково
8                  район Раменки
9             Останкинский район
Name: area, dtype: object</code></pre>
</div>
</div>
<div class="cell markdown">
<p>Посмотрим распределение заведения на карте: <a href="https://disk.yandex.ru/client/recent?idApp=client&amp;dialog=slider&amp;idDialog=%2Fdisk%2F%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA%D0%BD%D0%BE%D0%B9%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%2Fmap.png" class="uri">https://disk.yandex.ru/client/recent?idApp=client&amp;dialog=slider&amp;idDialog=%2Fdisk%2F%D0%92%D1%8B%D0%BF%D1%83%D1%81%D0%BA%D0%BD%D0%BE%D0%B9%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%2Fmap.png</a></p>
</div>
<div class="cell markdown">
<p><font color=' 06623b'> Во-вторых, раз уж я показала топ улиц - лидер по заведениям - проспект Мира - а он находится в ЦАО.</p>
<p><font color=' 06623b'> В завершении, можно использовать внешний источник по разбивке улиц Москвы на районы (*.csv).</p>
</div>
<div class="cell code" data-execution_count="27">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>districts <span class="op">=</span> pd.read_csv(<span class="st">&#39;http://hubofdata.ru/storage/f/2013-10-22T09%3A25%3A27.793Z/mosgaz-streets.csv&#39;</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>districts <span class="op">=</span> districts.groupby([<span class="st">&#39;streetname&#39;</span>]).agg({<span class="st">&#39;okrug&#39;</span>:<span class="st">&#39;first&#39;</span>}).reset_index()</span></code></pre></div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Посмотрим, какие районы самые топовые по количеству объектов.</p>
</div>
<div class="cell code" data-execution_count="28">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>data_new[<span class="st">&#39;street&#39;</span>] <span class="op">=</span> data_new[<span class="st">&#39;street&#39;</span>].<span class="bu">str</span>.strip()</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>top_okrug <span class="op">=</span> pd.merge(left<span class="op">=</span>data_new, right<span class="op">=</span>districts, left_on<span class="op">=</span><span class="st">&#39;street&#39;</span>, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                     right_on<span class="op">=</span><span class="st">&#39;streetname&#39;</span>)[[<span class="st">&#39;okrug&#39;</span>,<span class="st">&#39;id&#39;</span>]].groupby([<span class="st">&#39;okrug&#39;</span>]).count().reset_index()</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>hist(<span class="dv">15</span>,<span class="dv">5</span>,top_okrug.sort_values(<span class="st">&#39;id&#39;</span>, ascending <span class="op">=</span> <span class="va">True</span>),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">&#39;Top-10 районов по количеству объектов общественного питания&#39;</span>, <span class="st">&#39;sienna&#39;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.7/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/788265c64458f5935b66def6b4e0628126697d3f.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> Как и ожидалось, самый большой охват по кол-ву объектов в ЦАО, далее Юг и Запад.</p>
<p><font color='06623b'> Интересно, а есть ли улицы с один типом объекта общественного питания? Сколько их по районам?</p>
</div>
<div class="cell code" data-execution_count="29">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Найдите число улиц с одним объектом общественного питания. </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Воспользуйтесь внешней информацией и ответьте на вопрос — в каких районах Москвы находятся эти улицы?</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>count_steet <span class="op">=</span> (pd.merge(left<span class="op">=</span>data_new, right<span class="op">=</span>districts, left_on<span class="op">=</span><span class="st">&#39;street&#39;</span>, right_on<span class="op">=</span><span class="st">&#39;streetname&#39;</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a> .pivot_table(index<span class="op">=</span>[<span class="st">&#39;street&#39;</span>, <span class="st">&#39;okrug&#39;</span>], values<span class="op">=</span><span class="st">&#39;object_type&#39;</span>, aggfunc <span class="op">=</span> <span class="st">&#39;count&#39;</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a> .reset_index()</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a> .query(<span class="st">&#39;object_type == 1&#39;</span>))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>count_steet <span class="op">=</span> count_steet.groupby(<span class="st">&#39;okrug&#39;</span>).agg({<span class="st">&#39;street&#39;</span>:<span class="st">&#39;nunique&#39;</span>}).reset_index().sort_values(<span class="st">&#39;street&#39;</span>, ascending <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>hist(<span class="dv">15</span>,<span class="dv">5</span>,count_steet, <span class="st">&#39;Количество улиц по регионам с одним типом общественного питания&#39;</span>, <span class="st">&#39;sienna&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/25060b1be8b207f8c4a3cac74af5a662813832e1.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> В ЦАО 171 улиц могут похвастаться только одним типом объекта!</p>
<p><font color='06623b'> Как распределяется количество посадочных мест для топовых улиц?</p>
<p><font color='red'> Думаю, что в ЦАО большая конкуренция между объектами, и следовательно, отдельную улицу "захватывает" конкретный тип заведения.</p>
</div>
<div class="cell code" data-execution_count="30">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Посмотрите на распределение количества посадочных мест для улиц с большим количеством объектов общественного питания. </span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Какие закономерности можно выявить?</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>st_by_number <span class="op">=</span> data_new[data_new[<span class="st">&#39;street&#39;</span>].isin(street_top[<span class="st">&#39;street&#39;</span>].<span class="bu">str</span>.strip().unique().tolist())]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>f, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.lineplot(x<span class="op">=</span><span class="st">&quot;street&quot;</span>, y<span class="op">=</span><span class="st">&quot;number&quot;</span>, data<span class="op">=</span>st_by_number, color<span class="op">=</span><span class="st">&#39;olive&#39;</span>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>ax.<span class="bu">set</span>(ylabel<span class="op">=</span><span class="st">&quot;&quot;</span>, xlabel<span class="op">=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> g.get_xticklabels():</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    item.set_rotation(<span class="dv">30</span>)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Распределение количества посадочных мест для улиц с большим количеством объектов общественного питания&#39;</span>, </span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>             loc<span class="op">=</span><span class="st">&#39;left&#39;</span>, pad<span class="op">=</span><span class="dv">12</span>, fontweight<span class="op">=</span><span class="st">&quot;bold&quot;</span>)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>sns.despine(left<span class="op">=</span><span class="va">True</span>, bottom<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/d3ba21f2d603ccc1f3933301c21fff4d07968fc6.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="31">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(st_by_number, hue<span class="op">=</span><span class="st">&#39;street&#39;</span>, size<span class="op">=</span><span class="dv">9</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/opt/conda/lib/python3.7/site-packages/seaborn/axisgrid.py:2065: UserWarning: The `size` parameter has been renamed to `height`; pleaes update your code.
  warnings.warn(msg, UserWarning)
</code></pre>
</div>
<div class="output execute_result" data-execution_count="31">
<pre><code>&lt;seaborn.axisgrid.PairGrid at 0x7f038d08dbd0&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_d599ddd01520452db0555ff579e2c3ce/3f4d3cee8c50be5251e0210e295854c15ba60b5e.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><font color='06623b'> На Кутузовском проспекте самый большой разброс и, соответственно, максимум по среднему кол-ву посадочных мест.</p>
</div>
<section id="итоги" class="cell markdown">
<h2>Итоги:</h2>
<p><font color='06623b'> Самое перспективное заведение на данный момент - сетевое кафе. С небольшим количеством посадочных мест, но развитой сетью. Такие характеристики сейчас носят топовые заведения Москвы.</p>
<p><font color='06623b'> Если говорить про территорию: по месторасположению лидирует ЦАО, в частности Кутузовский проспект (при этом он не является лидиров по количеству сетевых заведений). Следовательно, данная территория является перспективной для дальнейшего освоения, - около 171 улиц ЦАО погут похвастаться только одним типом заведения.</p>
<p><font color='06623b'> Учитывая тип заведения, территорию размещения, а также новизну "подачи" открываемого объекта, может быть обеспечен большой охват клиентов.</p>
</section>
<section id="шаг-3-презентация-для-инвестеров" class="cell markdown">
<h2>Шаг №3. Презентация для инвестеров</h2>
</section>
<div class="cell markdown">
<p>доступна по ссылке: <a href="https://yadi.sk/i/f5wo_ulzWRXyeQ" class="uri">https://yadi.sk/i/f5wo_ulzWRXyeQ</a></p>
</div>
</body>
</html>
